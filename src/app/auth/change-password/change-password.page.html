<ion-content [fullscreen]="true" class="bg-white">
  <div class="relative mx-auto flex h-full w-full items-center justify-center px-4 py-8 sm:px-6">
    <div class="pointer-events-none absolute inset-0 -z-10 hidden overflow-hidden sm:block">
      <div
        class="absolute -top-[12vw] -right-[10vw] size-[40vw] rounded-full border-2 border-brand-50 sm:top-[-6rem] sm:right-[-5rem] sm:size-64 md:size-72 lg:size-80"></div>
      <div
        class="absolute -bottom-[10vw] -left-[10vw] size-[32vw] rotate-12 border-2 border-brand-100 sm:bottom-[-6rem] sm:left-[-6rem] sm:size-56 md:size-64"></div>
    </div>

    <div class="w-full max-w-sm rounded-2xl bg-white p-4 sm:p-6">
      <div class="mb-6 text-center sm:mb-8">
        <app-text-title [text]="'Restablecer Contraseña'"></app-text-title>
        <p class="mt-2 text-sm font-medium leading-snug text-neutral-800/80 sm:text-base">
          Ingresa tu correo y actualiza tu contraseña para continuar.
        </p>
      </div>

      <form class="space-y-4" (ngSubmit)="onSubmit()">
        <div class="space-y-3 -mx-4 sm:mx-0">
          <app-form-input
            name="email"
            type="email"
            placeholder="Correo electrónico"
            icon="mail-outline"
            autocomplete="email"
            [required]="true"
            [(ngModel)]="email"></app-form-input>

          <app-form-input
            name="currentPassword"
            type="password"
            placeholder="Contraseña actual"
            icon="lock-closed-outline"
            autocomplete="current-password"
            [required]="true"
            [(ngModel)]="currentPassword"></app-form-input>

          <app-form-input
            name="newPassword"
            type="password"
            placeholder="Nueva contraseña"
            icon="key-outline"
            autocomplete="new-password"
            [required]="true"
            [(ngModel)]="newPassword"></app-form-input>

          <app-form-input
            name="confirmNewPassword"
            type="password"
            placeholder="Confirma la nueva contraseña"
            icon="checkmark-done-outline"
            autocomplete="new-password"
            [required]="true"
            [(ngModel)]="confirmNewPassword"></app-form-input>
        </div>

        <div class="grid gap-4 pt-1">
          <app-themed-button type="submit" variant="primary" [disabled]="isLoading">
            <ng-container *ngIf="!isLoading; else loadingTpl">Actualizar contraseña</ng-container>
          </app-themed-button>
          <app-themed-button type="button" variant="secondary" (clicked)="goToLogin()">
            Volver a iniciar sesión
          </app-themed-button>
        </div>

        <p *ngIf="errorMessage" class="text-center text-sm text-red-500">{{ errorMessage }}</p>
        <p *ngIf="successMessage" class="text-center text-sm text-green-600">{{ successMessage }}</p>

        <ng-template #loadingTpl>
          <span class="flex items-center justify-center gap-2">
            <ion-spinner name="crescent"></ion-spinner>
            Actualizando...
          </span>
        </ng-template>
      </form>
    </div>
  </div>
</ion-content>
